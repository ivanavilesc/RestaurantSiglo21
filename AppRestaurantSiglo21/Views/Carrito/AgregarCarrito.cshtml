@model IEnumerable<AppRestaurantSiglo21.Models.PRODUCTO>

@{
    ViewBag.Title = "Index";
    Layout = Session["Layout"].ToString();
}


<link href="~/Content/css/Ordenes.css" rel="stylesheet" />

<div class="container">


    <div class="card text-center">
        <div class="card-body">
            <h4>Detalle de Orden</h4>
        </div>
    </div>
    <br />
    <p>
        @Html.ActionLink("Plato de Fondo", "DetailPlato", "CartaDigital", new { idorden = @Session["idorden"] }, new { @class = "btn btn-primary" }) |
        @Html.ActionLink("Bebestible", "DetailBebestible", "CartaDigital", new { idorden = @Session["idorden"] }, new { @class = "btn btn-primary" }) |
        @Html.ActionLink("Ensaladas", "DetailEnsaladas", "CartaDigital", new { idorden = @Session["idorden"] }, new { @class = "btn btn-primary" }) |
        @Html.ActionLink("Postres", "DetailPostres", "CartaDigital", new { idorden = @Session["idorden"] }, new { @class = "btn btn-primary" })
    </p>
    <form method="post" action="/Carrito/AgregarCarrito">
        <table class="table" style="font-family: Helvetica Neue, Helvetica, Arial, sans-serif">
            <tr>
                <th>
                    Plato
                </th>
                <th>
                    Precio
                </th>
                <th>
                    Cantidad
                </th>
                <th>
                    Total
                </th>
                <th> </th>
            </tr>
            @{
                double total = 0;
            }
            @if (Session["carrito"] != null)
            {
                foreach (var item in Session["carrito"] as List<AppRestaurantSiglo21.Models.CarritoItem>)
                {
                    total += (double)(item.Cantidad * item.Producto.PRECIOPRODUCTO);
                    <tr>
                        <td>
                            @Html.DisplayFor(model => item.Producto.DESCPRODUCTO)
                        </td>
                        <td>
                            @String.Format("{0:C}", item.Producto.PRECIOPRODUCTO)
                        </td>
                        <td>
                            @Html.EditorFor(model => item.Cantidad)
                        </td>
                        <td>
                            @String.Format("{0:C}", (item.Cantidad * item.Producto.PRECIOPRODUCTO))
                        </td>
                        <td>
                            @Html.ActionLink("Eliminar", "Delete", "Carrito", new { id = item.Producto.IDPRODUCTO }, new { @class = "btn btn-danger" })
                        </td>

                    </tr>
                }


            }


            <tfoot>
                <tr>
                    <th colspan="4">Total</th>
                    <th>@String.Format("{0:C}", total)</th>
                </tr>
            </tfoot>
        </table>
        @*<input type="hidden" id="idorden" name="idorden" value=@Session["idorden"] />*@


        <input type="hidden" id="idorden" name="idorden" value="@Session["idorden"]"/>
        @if (ViewBag.message != null)
        {
            <script type="text/javascript">
                        window.onload = function () {
                        alert("@ViewBag.message");
                    };
            </script>

        }
        <br />
        <br />
        <div>
            <a>@Html.ActionLink("Volver atrás", "Principal", "CartaDigital", new { idorden =@Session["idorden"] }, new { @class = "btn btn-secondary" })</a>

            <button type="submit" class="btn btn-warning">Confirmar Orden</button>
            @if (ViewBag.message != null)
            {
                <script type="text/javascript">
                    window.onload = function () {
                        alert("@ViewBag.message");
                    };
                </script>

            }


        </div>
    </form>
</div>
